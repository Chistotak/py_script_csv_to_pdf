# py_script_csv_to_pdf

# Генератор Описаний Релиза из Jira CSV в DOCX

Этот Python-скрипт предназначен для автоматического создания файла `.docx` с описанием релиза на основе данных, выгруженных из Jira в формате `.csv`. Скрипт позволяет гибко настраивать внешний вид и содержимое отчета через конфигурационные файлы.

## Основные Возможности

*   Чтение задач из CSV-файла, экспортированного из Jira.
*   Генерация отчета в формате `.docx`.
*   Группировка задач по версиям микросервисов.
*   Опциональная группировка задач по их типам внутри каждой версии микросервиса.
*   Кастомизация отображаемых имен для версий микросервисов (например, "FR2.3.6" -> "Сервис Фронтенда (версия 2.3.6)").
*   Кастомизация отображаемых имен для типов задач (например, "Bug" -> "Исправленные ошибки").
*   Добавление логотипа компании в начало отчета.
*   Создание сводной таблицы с перечнем микросервисов и их версий, затронутых в релизе.
*   Гибкая настройка внешнего вида документа (шрифты, размеры, цвета, отступы) через отдельный файл конфигурации стилей.
*   Управление основными параметрами (пути к файлам, маппинги колонок) через основной конфигурационный файл.
*   Возможность переопределения некоторых параметров через аргументы командной строки.

## Требования

*   Python 3.7+
*   Библиотека `python-docx`:
    ```bash
    pip install python-docx
    ```

## Структура Проекта

Рекомендуется следующая структура папок:
release_notes_generator/
├── main.py # Главный исполняемый скрипт
├── csv_importer.py # Модуль для работы с CSV
├── docx_creator.py # Модуль для генерации DOCX
├── config.ini # Основной конфигурационный файл
├── styles.ini # Конфигурационный файл для стилей и форматирования
├── logo.png # (Опционально) Файл логотипа
└── release.csv # (Пример) Ваш CSV-файл с данными из Jira


## Конфигурация

Скрипт использует два основных конфигурационных файла в формате INI: `config.ini` и `styles.ini`.

### 1. `config.ini` (Основная конфигурация)

Этот файл управляет путями к файлам, маппингом колонок CSV, именами микросервисов и типов задач.

**Пример `config.ini`:**

```ini
[General]
; Пути к файлам (могут быть относительными к директории, где лежит config.ini, или абсолютными)
csv_input_file = release.csv
docx_output_file = release_notes_generated.docx
logo_path = logo.png 
styles_config_file = styles.ini ; Путь к файлу конфигурации стилей

logo_width_inches = 1.5         ; Ширина логотипа в дюймах
release_title_format = Отчет по релизу: {{global_version}} ; Шаблон для заголовка, {{global_version}} будет заменено
; release_title_override = Мой Супер Релиз ; Если указано, переопределяет release_title_format
use_issue_type_grouping = true  ; Включить (true) или отключить (false) группировку по типам задач

[Columns]
; Имена колонок в вашем CSV-файле
key = Issue key
fix_versions = Fix Version/s ; Колонка, содержащая версии (может быть несколько с таким именем)
customer_desc = Custom field (Description for the customer)
install_instructions = Custom field (Инструкция по установке)
issue_type = Issue Type

[MicroserviceVersions]
; Маппинг префиксов версий микросервисов на полные отображаемые имена
; Формат: ПРЕФИКС_В_CSV = Отображаемое Имя (версия {{version}})
FR = Сервис Фронтенда (версия {{version}})
IN = Интеграционный Сервис (версия {{version}})
AM = Прикладной Модуль (версия {{version}})

[IssueTypeNames]
; Маппинг системных имен типов задач из CSV на отображаемые имена
; Ключи должны точно соответствовать значениям из CSV (с учетом регистра)
Bug = Исправленные ошибки
Story = Реализованные пользовательские истории
Improvement = Улучшения
Task = Задачи
Sub-task = Подзадачи
New Feature = Новая функциональность

